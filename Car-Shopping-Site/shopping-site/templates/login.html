<!DOCTYPE html>
{% load AppBase_tag %}
<html lang="en">
<head>
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"/>
    <meta charset="utf-8"/>
    <title>{% sitetitle_tag %}</title>
    <meta name="description" content="User login page"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0"/>
    <!-- bootstrap & fontawesome -->
    <link rel="stylesheet" href="/static/assets/css/bootstrap.css"/>
    <link rel="stylesheet" href="/static/assets/css/font-awesome.css"/>
    <!-- text fonts -->
    <link rel="stylesheet" href="/static/assets/css/ace-fonts.css"/>
    <!-- ace styles -->
    <link rel="stylesheet" href="/static/assets/css/ace.css"/>
    <!--[if lte IE 9]>
			<link rel="stylesheet" href="/static/assets/css/ace-part2.css" />
		<![endif]-->
    <link rel="stylesheet" href="/static/assets/css/ace-rtl.css"/>
    <!-- page specific plugin styles -->
    <link rel="stylesheet" href="/static/assets/css/jquery-ui.custom.css"/>
    <link rel="stylesheet" href="/static/assets/css/jquery.gritter.css"/>

    <!--[if lte IE 9]>
		  <link rel="stylesheet" href="/static/assets/css/ace-ie.css" />
		<![endif]-->
    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
		<script src="/static/assets/js/html5shiv.js"></script>
		<script src="/static/assets/js/respond.js"></script>
		<![endif]-->


</head>

<body class="login-layout">
<div class="main-container" id="app" style="margin-top: 120px">
    <div class="main-content">
        <div class="row">
            <div class="col-sm-10 col-sm-offset-1">
                <div class="login-container">
                    <div class="center">
                        <h1>
                            <i class="ace-icon fa fa-globe green"></i>
                            <span class="red">{% sitetitle_tag %}</span>
                            {#									<span class="white" id="id-text2">Application</span>#}
                        </h1>
                        {#								<h4 class="blue" id="id-company-text">&copy; Company Name</h4>#}
                    </div>

                    <div class="space-6"></div>

                    <div class="position-relative">
                        <div id="login-box" class="login-box visible widget-box no-border">
                            <div class="widget-body">
                                <div class="widget-main">
                                    {#											<h4 class="header blue lighter bigger">#}
                                    {#												<i class="ace-icon fa fa-coffee green"></i>#}
                                    {#												登录#}
                                    {#											</h4>#}

                                    <div class="space-6"></div>
                                    <div class="alert alert-danger" v-if="errorShow3">
                                        <button type="button" class="close" data-dismiss="alert"
                                                @click="closeErrorAlert">
                                            <i class="ace-icon fa fa-times"></i>
                                        </button>
                                        <strong>Error!</strong>
                                        [[errorMessage]]
                                        <br/>
                                    </div>
                                    <form>
                                        <fieldset>
                                            <label class="block clearfix">
														<span class="block input-icon input-icon-right">
															<input type="text" class="form-control"
                                                                   placeholder="Username" v-model="loginName"/>
															<i class="ace-icon fa fa-user"></i>
														</span>
                                            </label>

                                            <label class="block clearfix">
														<span class="block input-icon input-icon-right">
															<input type="password" class="form-control"
                                                                   placeholder="Password" v-model="loginPsd"/>
															<i class="ace-icon fa fa-lock"></i>
														</span>
                                            </label>

                                            <div class="space"></div>

                                            <div class="clearfix">
                                                <label class="inline">
                                                    <input type="checkbox" class="ace"/>
                                                    <span class="lbl">Remember Me</span>
                                                </label>

                                                <button type="button"
                                                        class="width-35 pull-right btn btn-sm btn-primary"
                                                        @click="userLogin">
                                                    <i class="ace-icon fa fa-key"></i>
                                                    <span class="bigger-110">Login</span>
                                                </button>
                                            </div>

                                            <div class="space-4"></div>
                                        </fieldset>
                                    </form>

                                    {#											<div class="social-or-login center">#}
                                    {#												<span class="bigger-110">Or Login Using</span>#}
                                    {#											</div>#}
                                    {##}
                                    {#											<div class="space-6"></div>#}
                                    {##}
                                    {#											<div class="social-login center">#}
                                    {#												<a class="btn btn-primary">#}
                                    {#													<i class="ace-icon fa fa-facebook"></i>#}
                                    {#												</a>#}
                                    {##}
                                    {#												<a class="btn btn-info">#}
                                    {#													<i class="ace-icon fa fa-twitter"></i>#}
                                    {#												</a>#}
                                    {##}
                                    {#												<a class="btn btn-danger">#}
                                    {#													<i class="ace-icon fa fa-google-plus"></i>#}
                                    {#												</a>#}
                                    {#											</div>#}
                                </div><!-- /.widget-main -->

                                <div class="toolbar clearfix">
                                    <div>
{#                                        <a href="#" data-target="#forgot-box" class="forgot-password-link">#}
{#                                            <i class="ace-icon fa fa-arrow-left"></i>#}
{#                                            忘记密码？#}
{#                                        </a>#}
                                    </div>

                                    <div>
                                        <a href="#" data-target="#signup-box" class="user-signup-link">
                                            Register
                                            <i class="ace-icon fa fa-arrow-right"></i>
                                        </a>
                                    </div>
                                </div>
                            </div><!-- /.widget-body -->
                        </div><!-- /.login-box -->

                        <div id="forgot-box" class="forgot-box widget-box no-border">
                            <div class="widget-body">
{#                                <div class="widget-main">#}
{#                                    <h4 class="header red lighter bigger">#}
{#                                        <i class="ace-icon fa fa-key"></i>#}
{#                                        找回密码#}
{#                                    </h4>#}
{##}
{#                                    <div class="space-6"></div>#}
{#                                     <div class="alert alert-danger" v-if="errorShow2">#}
{#                                        <button type="button" class="close" data-dismiss="alert"#}
{#                                                @click="closeErrorAlert">#}
{#                                            <i class="ace-icon fa fa-times"></i>#}
{#                                        </button>#}
{#                                        <strong>Error!</strong>#}
{#                                        [[errorMessage]]#}
{#                                        <br/>#}
{#                                    </div>#}
{#                                    <div class="alert alert-success" v-if="messageShow">#}
{#                                        <button type="button" class="close" data-dismiss="alert"#}
{#                                                @click="closeSuccessAlert">#}
{#                                            <i class="ace-icon fa fa-times"></i>#}
{#                                        </button>#}
{#                                        <strong>Success!</strong>#}
{#                                        [[successMessage]]#}
{#                                        <br/>#}
{#                                    </div>#}
{#                                    <p>#}
{#                                        输入账号邮箱#}
{#                                    </p>#}
{#                                    <form>#}
{#                                        <fieldset>#}
{#                                            <label class="block clearfix">#}
{#														<span class="block input-icon input-icon-right">#}
{#															<input type="email" class="form-control"#}
{#                                                                   placeholder="Email" v-model="findEmail"/>#}
{#															<i class="ace-icon fa fa-envelope"></i>#}
{#														</span>#}
{#                                            </label>#}
{##}
{#                                            <div class="clearfix">#}
{#                                                <button type="button" class="width-35 pull-right btn btn-sm btn-danger" @click="findUser">#}
{#                                                    <i class="ace-icon fa fa-lightbulb-o"></i>#}
{#                                                    <span class="bigger-110">发送!</span>#}
{#                                                </button>#}
{#                                            </div>#}
{#                                        </fieldset>#}
{#                                    </form>#}
{#                                </div><!-- /.widget-main -->#}

                                <div class="toolbar center">
                                    <a href="#" data-target="#login-box" class="back-to-login-link">
                                        Back to Login
                                        <i class="ace-icon fa fa-arrow-right"></i>
                                    </a>
                                </div>
                            </div><!-- /.widget-body -->
                        </div><!-- /.forgot-box -->

                        <div id="signup-box" class="signup-box widget-box no-border">
                            <div class="widget-body">
                                <div class="widget-main">
                                    <h4 class="header green lighter bigger">
                                        <i class="ace-icon fa fa-users blue"></i>
                                        Register
                                    </h4>

                                    <div class="space-6"></div>
                                    <p> Please fill the form: </p>
                                    <div class="alert alert-danger" v-if="errorShow">
                                        <button type="button" class="close" data-dismiss="alert"
                                                @click="closeErrorAlert">
                                            <i class="ace-icon fa fa-times"></i>
                                        </button>
                                        <strong>Error!</strong>
                                        [[errorMessage]]
                                        <br/>
                                    </div>
                                    <form>
                                        <fieldset>
{#                                            <label class="block clearfix">#}
{#														<span class="block input-icon input-icon-right">#}
{#															<input type="email" class="form-control"#}
{#                                                                   placeholder="Email" v-model="userEmail"/>#}
{#															<i class="ace-icon fa fa-envelope"></i>#}
{#														</span>#}
{#                                            </label>#}

                                            <label class="block clearfix">
														<span class="block input-icon input-icon-right">
															<input type="text" class="form-control"
                                                                   placeholder="Username" v-model="userName"/>
															<i class="ace-icon fa fa-user"></i>
														</span>
                                            </label>

                                            <label class="block clearfix">
														<span class="block input-icon input-icon-right">
															<input type="password" class="form-control"
                                                                   placeholder="Password" v-model="userPsd"/>
															<i class="ace-icon fa fa-lock"></i>
														</span>
                                            </label>

                                            <label class="block clearfix">
														<span class="block input-icon input-icon-right">
															<input type="password" class="form-control"
                                                                   placeholder="Repeat password" v-model="userRPsd"/>
															<i class="ace-icon fa fa-retweet"></i>
														</span>
                                            </label>

                                            <label class="block">
                                                <input type="checkbox" class="ace" v-model="acceptAd"/>
                                                <span class="lbl"style="color: red">
															Register as Car Seller
														</span>
                                            </label>

                                            <div class="space-24"></div>

                                            <div class="clearfix">
                                                <button type="reset" class="width-30 pull-left btn btn-sm">
                                                    <i class="ace-icon fa fa-refresh"></i>
                                                    <span class="bigger-110">Reset</span>
                                                </button>

                                                <button type="button"
                                                        class="width-65 pull-right btn btn-sm btn-success"
                                                        @click="RegisterUser">
                                                    <span class="bigger-110">Register</span>

                                                    <i class="ace-icon fa fa-arrow-right icon-on-right"></i>
                                                </button>
                                            </div>
                                        </fieldset>
                                    </form>
                                </div>

                                <div class="toolbar center">
                                    <a href="#" data-target="#login-box" class="back-to-login-link">
                                        <i class="ace-icon fa fa-arrow-left"></i>
                                        Back to Login
                                    </a>
                                </div>
                            </div><!-- /.widget-body -->
                        </div><!-- /.signup-box -->
                    </div><!-- /.position-relative -->

                    {#							<div class="navbar-fixed-top align-right">#}
                    {#								<br />#}
                    {#								&nbsp;#}
                    {#								<a id="btn-login-dark" href="#">Dark</a>#}
                    {#								&nbsp;#}
                    {#								<span class="blue">/</span>#}
                    {#								&nbsp;#}
                    {#								<a id="btn-login-blur" href="#">Blur</a>#}
                    {#								&nbsp;#}
                    {#								<span class="blue">/</span>#}
                    {#								&nbsp;#}
                    {#								<a id="btn-login-light" href="#">Light</a>#}
                    {#								&nbsp; &nbsp; &nbsp;#}
                    {#							</div>#}
                </div>
            </div><!-- /.col -->
        </div><!-- /.row -->
    </div><!-- /.main-content -->
</div><!-- /.main-container -->

<!-- basic scripts -->

<!--[if !IE]> -->
<script type="text/javascript">
    window.jQuery || document.write("<script src='/static/assets/js/jquery.js'>" + "<" + "/script>");
</script>

<!-- <![endif]-->

<!--[if IE]>
<script type="text/javascript">
 window.jQuery || document.write("<script src='/static/assets/js/jquery1x.js'>"+"<"+"/script>");
</script>
<![endif]-->
<script type="text/javascript">
    if ('ontouchstart' in document.documentElement) document.write("<script src='/static/assets/js/jquery.mobile.custom.js'>" + "<" + "/script>");
</script>

<!-- inline scripts related to this page -->
<script type="text/javascript">
    jQuery(function ($) {
        $(document).on('click', '.toolbar a[data-target]', function (e) {
            e.preventDefault();
            var target = $(this).data('target');
            $('.widget-box.visible').removeClass('visible');//hide others
            $(target).addClass('visible');//show target
        });
        $('body').attr('class', 'login-layout blur-login');
        $('#id-text2').attr('class', 'white');
        $('#id-company-text').attr('class', 'light-blue');
    });


    //you don't need this, just used for changing background
    jQuery(function ($) {
        $('#btn-login-dark').on('click', function (e) {
            $('body').attr('class', 'login-layout');
            $('#id-text2').attr('class', 'white');
            $('#id-company-text').attr('class', 'blue');

            e.preventDefault();
        });
        $('#btn-login-light').on('click', function (e) {
            $('body').attr('class', 'login-layout light-login');
            $('#id-text2').attr('class', 'grey');
            $('#id-company-text').attr('class', 'blue');

            e.preventDefault();
        });
        $('#btn-login-blur').on('click', function (e) {
            $('body').attr('class', 'login-layout blur-login');
            $('#id-text2').attr('class', 'white');
            $('#id-company-text').attr('class', 'light-blue');

            e.preventDefault();
        });

    });
</script>
<script src="/static/assets/js/jquery.gritter.js"></script>
<script type="text/javascript" src="/static/js/vue.js"></script>
<script type="text/javascript" src="/static/js/lazyload.min.js"></script>
<script type="text/javascript" src="/static/js/axios.js"></script>
<script type="text/javascript" src="/static/js/qs.js"></script>
<script type="text/javascript" src="/static/js/http.js"></script>
<script>
    var vm = new Vue({
        el: '#app',
        // 分割符: 修改vue中显示数据的语法, 防止与django冲突
        delimiters: ['[[', ']]'],
        data: {
            {#userEmail: "",#}
            userName: "",
            userPsd: "",
            userRPsd: "",
            errorShow: false,
            errorShow2: false,
            errorShow3: false,
            errorMessage: "",
            acceptAd: false,
            loginName: "",
            loginPsd: "",
            {#findEmail:"",#}
            messageShow:false,
            successMessage:""



        },
        created() {
        },
        methods: {
              async findUser() {
                //用户登录
                {#if (this.findEmail == "") {#}
                {#    this.errorShow2 = true;#}
                {#    this.errorMessage = "邮箱未填写！"#}
                {#    return;#}
                {# } #}

                 let data = {email: this.findEmail,};
                {#let res = await axiosget("{%  url 'api_findpassword' %}", data);#}
                console.log(res);
                if (res.code == 200) {
                     this.messageShow = true;
                    this.successMessage = res.message;
                } else {
                    this.errorShow2 = true;
                    this.errorMessage = res.message;
                }
            },
            async userLogin() {
                //用户登录
                if (this.loginName == "") {
                    this.errorShow3 = true;
                    this.errorMessage = "Please fill your username!"
                    return;
                }

                if (this.loginPsd == "") {
                    this.errorShow3 = true;
                    this.errorMessage = "Please fill your password!"
                    return;
                }

                 let data = {username: this.loginName, password: this.loginPsd};
                let res = await axiospost("{%  url 'api_login' %}", data);
                console.log(res);
                if (res.code == 200) {
                    window.location.href = res.data.url;
                } else {
                    this.errorShow3 = true;
                    this.errorMessage = res.message;
                }
            },
            async RegisterUser() {
                //用户注册


                if (this.userName == "") {
                    this.errorShow = true;
                    this.errorMessage = "Please fill your username!"
                    return;
                }



                //判断密码是否一致
                if (this.userPsd != this.userRPsd) {
                    this.errorShow = true;
                    this.errorMessage = "Please input the same password twice!"
                    return;
                }
                let  userRole=""
                if(this.acceptAd)
                {
                    userRole="boss"
                }

                let data = {email: this.userEmail, name: this.userName, password: this.userPsd,role:userRole};
                let res = await axiospost("{%  url 'api_register' %}", data);
                console.log(res);
                if (res.code == 200) {
                    window.location.href = res.data.url;
                } else {
                    this.errorShow = true;
                    this.errorMessage = res.message;
                }
            },
            closeErrorAlert() {
                this.errorShow = false;
                 this.errorShow2 = false;
                  this.errorShow3 = false;
            },
            closeSuccessAlert()
            {
                 this.messageShow = false;
            }
        },
        computed: {
            // 计算属性的 getter
        }
    });
</script>
</body>
</html>
